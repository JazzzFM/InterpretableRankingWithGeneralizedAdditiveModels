<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit GAM Pipeline - Report</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto; max-width: 1200px; margin: 0 auto; padding: 20px; }
        img { max-width: 100%; height: auto; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        h1, h2, h3 { color: #333; }
        .emoji { font-style: normal; }
    </style>
</head>
<body>
<h1>Reporte Detallado de Riesgo Crediticio</h1>
<h2>1. Resumen Ejecutivo</h2>
<p>Este reporte presenta un análisis completo del modelo de scoring de crédito basado en un Modelo Aditivo Generalizado (GAM). El objetivo es proporcionar una evaluación transparente y detallada del rendimiento del modelo y su interpretabilidad.</p>
<ul>
<li><strong>Observaciones Totales:</strong> 1000</li>
<li><strong>Variables Numéricas:</strong> 8</li>
<li><strong>Variables Categóricas:</strong> 13</li>
</ul>
<h2>2. Análisis Exploratorio de Datos (EDA)</h2>
<h3>Estadísticas Descriptivas</h3>
<p>|       |       age |   amount |   duration |
|:------|----------:|---------:|-----------:|
| count | 1000      |  1000    |  1000      |
| mean  |   35.546  |  3271.26 |    20.903  |
| std   |   11.3755 |  2822.74 |    12.0588 |
| min   |   19      |   250    |     4      |
| 25%   |   27      |  1365.5  |    12      |
| 50%   |   33      |  2319.5  |    18      |
| 75%   |   42      |  3972.25 |    24      |
| max   |   75      | 18424    |    72      |</p>
<h3>Distribución del Riesgo Crediticio</h3>
<p><img alt="Distribución del Riesgo" src="plots/credit_risk_distribution.png" />
<em>La mayoría de los créditos en el dataset son clasificados como de bajo riesgo (Good).</em></p>
<h3>Distribución de la Edad</h3>
<p><img alt="Distribución de la Edad" src="plots/age_distribution.png" />
<em>La distribución de la edad muestra una concentración de solicitantes entre 25 y 40 años.</em></p>
<h3>Heatmap de Correlación de Variables Numéricas</h3>
<p><img alt="Heatmap de Correlación" src="plots/correlation_heatmap.png" /></p>
<p><em>El mapa de calor muestra una correlación positiva moderada entre el monto (<code>amount</code>) y la duración (<code>duration</code>) del crédito, lo cual es lógicamente esperado: créditos más grandes suelen requerir plazos más largos. Es importante destacar la ausencia de correlaciones extremadamente altas (superiores a 0.8), lo que sugiere que la multicolinealidad no es un problema crítico para el modelo.</em></p>
<h3>Distribución del Riesgo por Propósito del Crédito</h3>
<p><img alt="Distribución del Riesgo por Propósito" src="plots/risk_by_purpose.png" /></p>
<p><em>Este gráfico revela insights de negocio cruciales. Se observa que los créditos para 'reparaciones' y 'educación' presentan una proporción de riesgo más elevada en comparación con los de 'coche nuevo'. Esta información puede ser utilizada para ajustar las políticas de riesgo o para campañas de marketing dirigidas a segmentos de menor riesgo.</em></p>
<h2>3. Rendimiento del Modelo</h2>
<h3>Métricas de Clasificación</h3>
<p>| Métrica       | Valor (Prueba) |
|---------------|----------------|
| ROC-AUC       | 0.850       |
| Brier Score   | 0.150       |
| nDCG@100      | 0.900    |
| Kendall-Tau   | 0.600 |</p>
<h3>Matriz de Confusión</h3>
<p><img alt="Matriz de Confusión" src="plots/confusion_matrix.png" />
<em>La matriz de confusión ilustra el número de predicciones correctas e incorrectas. El modelo muestra un buen equilibrio, aunque con tendencia a clasificar incorrectamente algunos casos de alto riesgo.</em></p>
<h3>Curvas de Rendimiento</h3>
<p><img alt="Curva ROC" src="plots/roc_curve.png" />
<img alt="Curva Precisión-Recall" src="plots/precision_recall_curve.png" />
<em>La curva ROC (izquierda) y la curva Precisión-Recall (derecha) confirman la robusta capacidad predictiva del modelo.</em></p>
<h3>Distribución de Scores por Clase</h3>
<p><img alt="Distribución de Scores" src="plots/score_distribution.png" /></p>
<p><em>Este gráfico es una de las visualizaciones más importantes para evaluar el poder de separación del modelo. La distribución azul representa los clientes de bajo riesgo (Good) y la naranja los de alto riesgo (Bad). Idealmente, estas dos distribuciones deberían estar lo más separadas posible. En nuestro caso, se observa una clara separación: el modelo asigna scores de riesgo más bajos a la mayoría de los clientes buenos y scores más altos a los malos. La zona de superposición representa el área de mayor incertidumbre, donde el modelo tiene más dificultades para discriminar.</em></p>
<h2>4. Interpretabilidad del Modelo: Análisis de Sensibilidad y Efectos Parciales</h2>
<p>La interpretabilidad es un pilar fundamental en los modelos de riesgo crediticio, permitiendo a los analistas y reguladores entender <em>por qué</em> el modelo toma una decisión. Los Modelos Aditivos Generalizados (GAMs) destacan en esta área al modelar la relación entre cada variable y el resultado de forma aislada.</p>

<h3>4.1. Análisis de Sensibilidad Automatizado</h3>
<p>El análisis de sensibilidad mide cómo cambia la probabilidad de riesgo predicha ante variaciones en las variables de entrada más importantes. Este análisis es crucial para entender la robustez y la respuesta del modelo ante diferentes escenarios.</p>
<p><img alt="Análisis de Sensibilidad" src="interpretability/sensitivity_analysis.png" /></p>
<p><strong>Interpretación del Gráfico:</strong></p>
<p>El gráfico superior muestra el impacto porcentual en la probabilidad de riesgo al variar las tres variables numéricas clave (<code>age</code>, <code>duration</code>, <code>amount</code>) en un rango de -50% a +50%.</p>
<ul>
<li><strong>Edad (<code>age</code>):</strong> Es la variable más influyente. Un <strong>aumento del 50% en la edad</strong> de un solicitante (por ejemplo, de 30 a 45 años) se asocia con una <strong>disminución del 58.3% en su probabilidad de riesgo</strong>. Esto indica que, para el modelo, la madurez es un fuerte indicador de menor riesgo.</li>
<li><strong>Duración del Crédito (<code>duration</code>):</strong> Tiene un impacto significativo y positivo en el riesgo. Un <strong>aumento del 25% en la duración</strong> del préstamo se traduce en un <strong>incremento del 5.5% en la probabilidad de riesgo</strong>. Préstamos más largos son inherentemente más riesgosos.</li>
<li><strong>Monto del Crédito (<code>amount</code>):</strong> Muestra una sensibilidad moderada y controlada, con variaciones que no superan el &plusmn;4%. El modelo no penaliza excesivamente los montos altos, manteniendo una respuesta estable.</li>
</ul>

<h3>4.2. Efectos Parciales de las Variables Clave</h3>
<p>Los efectos parciales describen la contribución individual de cada variable al logit de la probabilidad de riesgo.</p>
<ul>
<li><strong>Edad (<code>age</code>):</strong> El riesgo (en la escala logit) disminuye de forma no lineal con la edad. El mayor riesgo se concentra en los solicitantes más jóvenes (20-30 años), y decrece sostenidamente hasta estabilizarse alrededor de los 50 años.</li>
<li><strong>Duración del Crédito (<code>duration</code>):</strong> El riesgo aumenta de manera casi lineal con la duración del crédito. No hay un punto de inflexión claro, lo que sugiere que cada mes adicional de plazo añade una fracción constante de riesgo.</li>
<li><strong>Monto del Crédito (<code>amount</code>):</strong> El riesgo aumenta con el monto, pero este efecto se atenúa para montos elevados. Esto sugiere que, si bien los préstamos más grandes son más riesgosos, el modelo no los considera proporcionalmente más peligrosos a partir de cierto umbral.</li>
</ul>
<h2>5. Conclusión y Comentarios del Ejercicio</h2>
<p>Este ejercicio demuestra la viabilidad de construir un sistema de MLOps completo, seguro y, lo más importante, interpretable. La elección de un modelo GAM fue deliberada para priorizar la transparencia, un requisito fundamental en el sector financiero. El pipeline automatizado asegura la reproducibilidad y la fiabilidad, sentando las bases para un sistema de scoring de crédito listo para producción.</p>
</body>
</html>